groups:
- name: service-alerts
  rules:
  - alert: ServiceDown
    expr: up == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "Service {{ $labels.job }} is down"
      description: "{{ $labels.instance }} of job {{ $labels.job }} has been down for more than 1 minute."

  - alert: HighErrorRate
    expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.05
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: "High error rate for {{ $labels.job }}"
      description: "{{ $labels.instance }} of job {{ $labels.job }} has error rate of {{ $value }}%"

  - alert: HighLatency
    expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 2
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: "High latency for {{ $labels.job }}"
      description: "{{ $labels.instance }} of job {{ $labels.job }} has 95th percentile latency of {{ $value }} seconds"

  - alert: HighMemoryUsage
    expr: (container_memory_usage_bytes{container!="POD",container!=""} / container_spec_memory_limit_bytes{container!="POD",container!=""}) > 0.8
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High memory usage for {{ $labels.container }}"
      description: "Container {{ $labels.container }} is using {{ $value }}% of its memory limit"

  - alert: HighCPUUsage
    expr: rate(container_cpu_usage_seconds_total{container!="POD",container!=""}[5m]) > 0.8
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High CPU usage for {{ $labels.container }}"
      description: "Container {{ $labels.container }} is using {{ $value }}% of its CPU limit"